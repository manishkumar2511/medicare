<nav class="navbar">
  <div class="nav-container">
    <div class="nav-header-row">
      <div class="nav-logo">
        <i class="pi pi-heart logo-text" style="font-size: 2rem;"></i>
        <span class="logo-text">MEDICARES</span>
      </div>
      <div class="hamburger" (click)="toggleMobileMenu()">
        <span class="bar"></span>
        <span class="bar"></span>
        <span class="bar"></span>
      </div>
    </div>
    <div class="nav-menu" [class.active]="mobileMenuOpen">
  <!-- Hide the main nav links when any user is logged in -->
  <ng-container *ngIf="!auth.currentUser()">
        <a class="nav-link" (click)="navigateToHome()">Home</a>
        <a routerLink="/pricing" class="nav-link" (click)="closeMenu()">Pricing</a>
        <a routerLink="/about" class="nav-link" (click)="closeMenu()">About</a>
        <a routerLink="/contact" class="nav-link" (click)="closeMenu()">Contact</a>
      </ng-container>

      <!-- Shown when logged in -->
      <ng-container *ngIf="currentUser">
        <!-- If role is SuperAdmin -->
        <ng-container *ngIf="isSuperAdmin(); else normalRole">
          <a routerLink="/dashboard" class="nav-link" (click)="closeMenu()">Dashboard</a>
          <a routerLink="/stores" class="nav-link" (click)="closeMenu()">Stores</a>
        </ng-container>
      
        <!-- Other roles -->
        <ng-template #normalRole>
          <a routerLink="/dashboard" class="nav-link" (click)="closeMenu()">Dashboard</a>
          <a routerLink="/transactions" class="nav-link" (click)="closeMenu()">Transactions</a>
          <a routerLink="/sales" class="nav-link" (click)="closeMenu()">Sales</a>
        </ng-template>
      </ng-container>

      <div class="nav-buttons">
  <ng-container *ngIf="!auth.currentUser(); else loggedIn">
          <a class="nav-link" (click)="navigateToLogin()">Login</a>
          <a class="nav-link" (click)="navigateToRegister()">Get Started</a>
        </ng-container>
        <ng-template #loggedIn>
          <div class="user-badge" title="Logged in user">
            <span class="user-email">{{ auth.currentUser()?.email }}</span>
            <div class="avatar-wrapper" (click)="toggleUserMenu()" style="cursor: pointer;">
              <div class="avatar">{{ (auth.currentUser()?.email || '') | slice:0:1 | uppercase }}</div>
              <span class="status-dot"></span>
            </div>
            <div class="user-menu" *ngIf="userMenuOpen">
              <button class="logout-btn" (click)="logout()">Logout</button>
            </div>
          </div>
        </ng-template>

        <i class="pi" [ngClass]="isDarkMode ? 'pi-moon' : 'pi-sun'" (click)="toggleTheme()"
          style="font-size: 1.5rem; cursor: pointer; margin-left: 1rem; color: var(--text-primary);"></i>
      </div>
    </div>
  </div>
</nav>